<?xml version="1.0" encoding="utf-8"?>
<xsl:stylesheet xmlns:xsl="http://www.w3.org/1999/XSL/Transform" version="1.0">
<xsl:template match="/">
<html>
<head>
    <title>Test Results</title>
</head>
<body>
    <h1 align="center">Test Results</h1>
        
  <table border="0" cellpadding="2" cellspacing="0" width="95%" style="border: #dcdcdc 1px solid;">
      <xsl:variable name="percent" select="format-number((test-results/@total - test-results/@errors) div test-results/@total * 100,'#.00')"/>
      <xsl:if test="$percent > 95">
        <tr>
          <td bgcolor='#33CC00' align="left">
              Generated by: <xsl:value-of select="test-results/@date"/> - <xsl:value-of select="test-results/@time"/>            
          </td>
        </tr>
        <tr>
          <td bgcolor='#33CC00'>
           $Name_of_Project
          </td>
        </tr>
      </xsl:if>

      <xsl:if test='$percent &lt;=  95'>
        <tr>
          <td bgcolor='#FF3300'>
              $Name_of_Project
          </td>          
        </tr>
        <tr>
          <td bgcolor='#FF3300' align="left">
              Generated: <xsl:value-of select="test-results/@date"/> - <xsl:value-of select="test-results/@time"/>           
          </td>
        </tr>
      </xsl:if>
  </table>
            
<h2 align="center">Results</h2>
    <table border="0" cellpadding="2" cellspacing="0" width="95%" style="border: #dcdcdc 1px solid;">
        <tr valign="top">
            <td>
                <b>Scenarious</b>
            </td>
            <td>
                <b>Passed</b>
            </td>
           
            <td>
                <b>Error</b>
            </td>
            <td>
                <b>Passed</b>
            </td>           
            <td>
                <b>Time</b>
            </td>
        </tr>
        <tr>
            <td>
               <xsl:value-of select="test-results/@total"/>
            </td>
            <td>
              <xsl:value-of select="test-results/@total - test-results/@errors"/>
            </td>
            <td>
                <xsl:value-of select="test-results/@errors"/>
            </td>
            <td>              
              <xsl:value-of select="format-number((test-results/@total - test-results/@errors) div test-results/@total * 100,'#.00')"/> %              
            </td>             
            <td>
               <xsl:value-of select="test-results/test-suite/@time"/>
            </td>
        </tr>
    </table>

  <h2 align="center">Info</h2>
  <table border="0" cellpadding="2" cellspacing="0" width="95%" style="border: #dcdcdc 1px solid;">
    <tr>
      <td>
        <b>Sowtware</b>
      </td>
      <td>
        <b>Version</b>
      </td>
    </tr>
    <tr>
      <td>
        Browser
      </td>
      <td>
        $Browser
      </td>
      </tr>
    <tr>
      <td>
        Nunit version
      </td>
      <td>
        <xsl:value-of select="test-results/environment/@nunit-version"/>
      </td>
    </tr>
    <tr>
      <td>
        Clr-version
      </td>
      <td>
        <xsl:value-of select="test-results/environment/@clr-version"/>
      </td>
    </tr>
    <tr>
      <td>
        Platform
      </td>
      <td>
        <xsl:value-of select="test-results/environment/@platform"/>
      </td>
    </tr>
    <tr>
      <td>
        Operating System
      </td>
      <td>
        <xsl:value-of select="test-results/environment/@os-version"/>
      </td>
    </tr>
 </table>
         
<h2 align="center" >Reserve results</h2>
      <table border="0" cellpadding="2" cellspacing="0" width="95%" style="border: #dcdcdc 1px solid;">
        <tr>
            <td width="25%">
              <center><b>Scenario</b></center>
            </td>            
            
          <td width="15%" align="left">
            <center><b>Result</b></center>
          </td>
          <td width="25%" align="left">
            <center><b>Error Message</b></center>
          </td>  

          <td width="15%" align="left">
            <center><b>Time</b></center>
          </td>
          
        </tr>

      <xsl:for-each select="//test-case">
        <tr>
          <td>
            <xsl:value-of select=" @name "/>
          </td>
                   
            <xsl:if test=" @result !='Error'">
             <td bgcolor='#33CC00'>
               <center><xsl:value-of select=" @result "/></center>
             </td>
              <td>
                <center> — </center>
              </td>
            </xsl:if>

          <xsl:if test=" @result !='Success'">
            <td bgcolor='#FF3300'>
              <center><xsl:value-of select=" @result "/></center>
            </td>
            <td>
              <center><xsl:value-of select="//message"/></center>
            </td>
          </xsl:if>

          <td>
            <center><xsl:value-of select=" @time "/></center>
          </td>
         
        </tr>
      </xsl:for-each>      
   </table>
        
 <!-- <hr size="1" width="95%" align="left"></hr> -->
 
</body>
</html>
</xsl:template>
</xsl:stylesheet>